parameters:
  delphiVersion: ''
  platform: 'x86'

steps:
- powershell: |
    $exe = Join-Path '.bin' 'tests.${{ parameters.delphiVersion }}.${{ parameters.platform }}.exe'
    if (-Not(Test-Path $exe))
    {
        Write-Host '##vso[task.complete result=skipped]Test executable for Delphi ${{ parameters.delphiVersion }} (${{ parameters.platform }}) not found.'
    }
    else
    {
        $cmd = "$exe -xunit2:results.xml"
        Invoke-Expression $cmd
    }
  displayName: Execute tests for Delphi ${{ parameters.delphiVersion }} (${{ parameters.platform }})